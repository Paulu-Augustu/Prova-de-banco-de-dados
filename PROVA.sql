CREATE DATABASE prova_PauloA_2015902;

CREATE USER 'PauloA_2015902'@'%' IDENTIFIED BY 'PauloA_2015902';

GRANT ALL PRIVILEGES ON aula_clovis91.* TO 'PauloA_2015902'@'%';

FLUSH PRIVILEGES

SHOW GRANTS FOR 'PauloA_2015902'@'%';

USE prova_PauloA_2015902;


/* CRIANDO AS TABELAS */


CREATE TABLE CURSO(
	
	IDCURSO INT PRIMARY KEY AUTO_INCREMENT,
	NOME_CURSO VARCHAR(30),
	DURACAO VARCHAR(7),
	TOTAL_PERIODOS INT,
	MODALIDADE VARCHAR(10)
);

CREATE TABLE PROFESSOR(
	
	IDPROFESSOR INT PRIMARY KEY AUTO_INCREMENT,
	NOME_PROFESSOR VARCHAR (50),
	EMAIL VARCHAR (30),
	TELEFONE VARCHAR (11),
	TITULACAO VARCHAR (20),
	CURSOS VARCHAR (30)
);

CREATE TABLE ALUNO(
	
	IDALUNO INT PRIMARY KEY AUTO_INCREMENT,
	NOME_ALUNO VARCHAR(50),
	MATRICULA INT (11),
	EMAIL VARCHAR(30),
	IDADE INT (3),
	TELEFONE VARCHAR (11),
	ID_CURSO INT
);

CREATE TABLE TCC(
	
	IDTCC INT PRIMARY KEY AUTO_INCREMENT,
	TITULO VARCHAR (100),
	RESUMO VARCHAR (100),
	SEMESTRE FLOAT (8,2),
	ID_PROFESSOR INT
);

CREATE TABLE BANCA(
	
	IDBANCA INT PRIMARY KEY AUTO_INCREMENT,
	ID_TCC INT
);

CREATE TABLE APRESENTACAO(
	
	IDAPRESENTACAO INT PRIMARY KEY AUTO_INCREMENT,
	ID_TCC INT,
	DATA VARCHAR (11),
	HORA VARCHAR (8),
	LOCALIZACAO VARCHAR (10),
	NOTA_FINAL FLOAT (3,1)
);


/* CRIANDO AS CHAVES ESTRANGEIRAS "FK(MOSTRAR QUE É CHAVE ESTRANGEIRA)_(NOME DA TABELA DE ONDE VAI ESTAR)_(NOME DA TABELA DE REFERENCIA) */

ALTER TABLE	
	ALUNO
ADD CONSTRAINT
	FK_ALUNO_CURSO
FOREIGN KEY
	(ID_CURSO)
REFERENCES
	CURSO(IDCURSO);
	
	

ALTER TABLE	
	TCC
ADD CONSTRAINT
	FK_TCC_PROFESSOR
FOREIGN KEY
	(ID_PROFESSOR)
REFERENCES
	PROFESSOR(IDPROFESSOR);
	
	
	
ALTER TABLE	
	BANCA
ADD CONSTRAINT
	FK_BANCA_TCC
FOREIGN KEY
	(ID_TCC)
REFERENCES
	TCC(IDTCC);
	
	

ALTER TABLE	
	APRESENTACAO
ADD CONSTRAINT
	FK_APRESENTACAO_TCC
FOREIGN KEY
	(ID_TCC)
REFERENCES
	TCC(IDTCC);
	
	

/* PREENCHENDO AS TABELAS*/

INSERT INTO CURSO
	(NOME_CURSO, DURACAO, TOTAL_PERIODOS, MODALIDADE)
VALUES
	('SISTEMAS DE INFORMAÇÃO', '4 ANOS', 8, 'PRESENCIAL'),
	('ENGENHARIA DA COMPUTAÇÃO', '5 ANOS', 10 , 'PRESENCIAL'),
	('ENGENHARIA DE SOFTWARE', '5 ANOS', 10 , 'EAD');
	

INSERT INTO PROFESSOR
	(NOME_PROFESSOR, EMAIL, TELEFONE, TITULACAO, CURSOS)
VALUES
	('ALLAN KARDEC GURGEL DO AMARAL', 'allan.gurgel@unisa.com', '69933333333', 'ESPECIALISTA', 'ENGENHARIA DA COMPUTAÇÃO'),
	('CLOVIS PEREIRA AGUIAR JUNIOR', 'clovis.junior@unisa.com', '69999999999', 'ESPECIALISTA', 'SISTEMA DE INFORMAÇÃO'),
	('EVANDRO SOUZA DE PEREIRA CORDEIRO', 'evandro.cordeiro@unisa.com', '69988888888', 'MESTRE', 'SISTEMA DE INFORMAÇÃO'),
	('GABRIEL CARRIJO BENTO TEIXEIRA', 'gabriel.teixeira@unisa.com', '69977777777', 'MESTRE', 'SISTEMA DE INFORMAÇÃO'),
	('GEORGEANO DANTAS MACIEL', 'georgeano.maciel@unisa.com', '69922222222', 'MESTRE', 'ENGENHARIA DA COMPUTAÇÃO'),
	('LILUYOUD CURY LACERDA', 'liluyoud.lacerda@unisa.com', '69966666666', 'MESTRE', 'SISTEMA DE INFORMAÇÃO'),
	('MATHEUS LUCAS LEAL', 'matheus.leal@unisa.com', '69911111111', 'MESTRE', 'ENGENHARIA DA COMPUTAÇÃO'),
	('NATÁLIA DE SOUZA NEVES', 'natália.neves@unisa.com', '69900000000', 'ESPECIALISTA', 'ENGENHARIA DA COMPUTAÇÃO'),
	('PAULO ALEXANDRE S. C. DA FONSECA', 'paulo.fonseca@unisa.com', '69955555555', 'ESPECIALISTA', 'SISTEMA DE INFORMAÇÃO'),
	('ROSANGELA SILVA CUNHA', 'rosangela.cunha@unisa.com', '69944444444', 'ESPECIALISTA', 'SISTEMA DE INFORMAÇÃO'),
	('VÂNIUS GARCIA PAIVA', 'vânius.paiva@unisa.com', '69999998888', 'ESPECIALISTA', 'ENGENHARIA DA COMPUTAÇÃO');
	
	
INSERT INTO ALUNO 
	(NOME_ALUNO, MATRICULA, EMAIL, IDADE, TELEFONE, ID_CURSO)
 VALUES
('Adrian Rafael Estevarengo de Matos', 901000587, 'matos@unisa.com', 33, '69900000001', 1),
('BRUNO YUTAKA SATO RAMOS GALVEZ', 2010621, 'galvez@unisa.com', 20, '69900000002', 2),
('Camila Galleti Froes', 901001078, 'froes@unisa.com', 21, '69900000003', 3),
('Carlos Charles Batista dos Santos', 901000794, 'santos@unisa.com', 20, '69900000004', 1),
('Cayo Reis Paiva', 901001046, 'paiva@unisa.com', 25, '69900000005', 2),
('DANILO DE OLIVEIRA SUDÁRIO', 2014916, 'sudário@unisa.com', 33, '69900000006', 3),
('FELIPE MARCELO NOGUEIRA LOPES', 1010452, 'lopes@unisa.com', 28, '69900000007', 1),
('Gabriel Araújo Silva', 901001115, 'silva@unisa.com', 33, '69900000008', 2),
('GUSTAVO RODRIGUES MENDES VALENTE', 1003171, 'valente@unisa.com', 26, '69900000009', 3),
('HAYDAN LUIZ MATOS DA ROCHA SOUZA', 2015794, 'souza@unisa.com', 20, '69900000010', 1),
('HERUS NEUHAUS', 2015435, 'neuhaus@unisa.com', 31, '69900000011', 2),
('IASMIM VIEIRA DE OLIVEIRA', 2015936, 'oliveira@unisa.com', 31, '69900000012', 3),
('Jean Gabriel Fernandes Laumem de Souza', 54394, 'souza@unisa.com', 27, '69900000013', 1),
('João Victor Duarte de Sousa', 54526, 'sousa@unisa.com', 22, '69900000014', 2),
('JOÃO VITOR MARTINS RUFINO', 2015617, 'rufino@unisa.com', 28, '69900000015', 3),
('JOSÉ PEDRO LIMA REBOUÇAS', 2016332, 'rebouças@unisa.com', 27, '69900000016', 1),
('Kevin Clemente de Freitas', 901001413, 'freitas@unisa.com', 30, '69900000017', 2),
('KLICIA KAMILLA CAVALCANTE SANTANA', 901001641, 'santana@unisa.com', 27, '69900000018', 3),
('Leticia Farias Ribeiro', 54269, 'ribeiro@unisa.com', 22, '69900000019', 1),
('Luan Pantoja Marques', 901001564, 'marques@unisa.com', 19, '69900000020', 2),
('LUAN VICTOR SOUZA ROCHA', 2015357, 'rocha@unisa.com', 31, '69900000021', 3),
('LUCAS COLDEBELLA TROVO', 901000997, 'trovo@unisa.com', 29, '69900000022', 1),
('Lucas Davi Miranda Dias Fogaça', 901001387, 'fogaça@unisa.com', 27, '69900000023', 2),
('LUIZ ELIAS LEITE DOS SANTOS', 901001527, 'santos@unisa.com', 31, '69900000024', 3),
('MARCIO D OLIVEIRA BASTOS', 901001834, 'bastos@unisa.com', 31, '69900000025', 1),
('Marcos Vinícius Correa Patriota', 54443, 'patriota@unisa.com', 30, '69900000026', 2),
('Marlon Gil Gomes', 901001638, 'gomes@unisa.com', 28, '69900000027', 3),
('MATHEUS ALZINO XAVIER DOS SANTOS', 54386, 'santos@unisa.com', 25, '69900000028', 1),
('Matheus Rossi Santiago', 2015970, 'santiago@unisa.com', 24, '69900000029', 2),
('PABLO MARTINEZ PALHARES GVOZDANOVIC VILLAR', 1011480, 'villar@unisa.com', 25, '69900000030', 3),
('Patrick Bueno Mota Lofrano', 901001400, 'lofrano@unisa.com', 29, '69900000031', 1),
('PAULO AUGUSTO PEDRO DA SILVA', 2015902, 'silva@unisa.com', 21, '69900000032', 2),
('Paulo Henrique Montenegro de Lima', 54453, 'lima@unisa.com', 22, '69900000033', 3),
('PEDRO HENRIQUE SANTOS DA COSTA', 2012481, 'costa@unisa.com', 24, '69900000034', 1),
('PEDRO LUCAS RODRIGUES MOURA', 2015826, 'moura@unisa.com', 21, '69900000035', 2),
('Ryan Oliveira da Silva', 2016410, 'silva@unisa.com', 21, '69900000036', 3),
('Sergio Victor Belarmino Diniz', 2016359, 'diniz@unisa.com', 31, '69900000037', 1),
('Thiago de Souza Aguiar', 901000267, 'aguiar@unisa.com', 28, '69900000038', 2),
('VINICIUS ALEXANDER DOS SANTOS SOARES', 901001798, 'soares@unisa.com', 25, '69900000039', 3),
('Vinícius Emanuel Guimarães Rodrigues', 901001375, 'rodrigues@unisa.com', 31, '69900000040', 1),
('Wenderliy Fernandes Vasconcelos', 901002097, 'vasconcelos@unisa.com', 28, '69900000041', 2),
('Wernnon Lucas Santos Ruiz', 901001397, 'ruiz@unisa.com', 23, '69900000042', 3),
('Yago Maia de Aquino', 901000912, 'aquino@unisa.com', 23, '69900000043', 1);


INSERT INTO TCC
	(TITULO, RESUMO, SEMESTRE, ID_PROFESSOR)
VALUES
	('Simulador de Ambientes para Testes de Cybersegurança', 'Plataforma para treinar especialistas em simulações de ataques e defesas', 2024.2, 2),
	('Automação e Otimização de Serviços em E-commerce com Chatbots', 'Desenvolvimento de um chatbot inteligente que vai além do atendimento básico', 2024.2, 3),
	('Blockchain na Gestão Pública', 'Soluções de blockchain para transparência em licitações e controle de gastos públicos', 2024.2, 4);


INSERT INTO BANCA
	(ID_TCC)
VALUES
	(1), (2), (3);
	

INSERT INTO APRESENTACAO
	(ID_TCC, DATA, HORA, LOCALIZACAO, NOTA_FINAL)
VALUES
	(1, '01/07/2025', '19:00:00', 'Lab. 04', NULL),
	(2, '01/07/2025', '19:00:00', 'Lab. 05', NULL),
	(3, '02/07/2025', '20:30:00', 'Lab. 04', NULL);
	

/* INSERINDO NOVA COLUNA PRA A TABELA TCC */

ALTER TABLE 
	TCC
ADD COLUMN 
	ID_ALUNO INT;
	

ALTER TABLE	
	TCC
ADD CONSTRAINT
	FK_TCC_ALUNO
FOREIGN KEY
	(ID_ALUNO)
REFERENCES
	ALUNO(IDALUNO);
	

ALTER TABLE
	TCC
MODIFY COLUMN 
	ID_ALUNO INT
AFTER
	SEMESTRE;
	

UPDATE 
	TCC
SET
	ID_ALUNO = 32
WHERE 
	IDTCC = 1;
	
	
UPDATE 
	TCC
SET
	ID_ALUNO = 1
WHERE 
	IDTCC = 2;
	

UPDATE 
	TCC
SET
	ID_ALUNO = 36
WHERE 
	IDTCC = 3;
	
	
/* INSERINDO MEMBROS DA BANCA */

ALTER TABLE
	BANCA
ADD COLUMN
	ID_PROFESSOR INT;


ALTER TABLE	
	BANCA
ADD CONSTRAINT
	FK_BANCA_PROFESSOR
FOREIGN KEY
	(ID_PROFESSOR)
REFERENCES
	PROFESSOR(IDPROFESSOR);
	
	
	
INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(1, 2);
	
INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(1, 4);
	
INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(1, 10);
	
	
	
INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(2, 3);
	
INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(2, 9);

INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(2, 6);	



INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(3, 4);
	
	INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(3, 2);
	
	INSERT INTO BANCA
	(ID_TCC, ID_PROFESSOR)
VALUES 
	(3, 10);
	
DELETE FROM BANCA
WHERE ID_PROFESSOR IS NULL;

/* INSERINDO NOTAS DA APRESENTAÇÃO */



UPDATE 
	APRESENTACAO
SET
	NOTA_FINAL = 8.9
WHERE
	ID_TCC = 1;



UPDATE 
	APRESENTACAO
SET
	NOTA_FINAL = 8.7
WHERE
	ID_TCC = 2;
	


UPDATE 
	APRESENTACAO
SET
	NOTA_FINAL = 9.0
WHERE
	ID_TCC = 3;
	

/* CÓDIGOS P/ CONSULTAS */

-- QUANTOS CURSOS EXISTEM?

SELECT 
	COUNT(NOME_CURSO) AS "TOTAL CURSOS"
FROM
	CURSO;
	
	
-- LISTANDO CURSOS COM MAIS DE 8 PERIODOS

SELECT
	NOME_CURSO
FROM
	CURSO
WHERE 
	TOTAL_PERIODOS > 8;
	
	
-- TOTAL DE NÚMERO DE PROFESSORES CADASTRADOS

SELECT 
	COUNT(*) AS "TOTAL DE PROFESSORES"
FROM 
	PROFESSOR;
	
	
-- LISTAR NOME E TITULAÇÃO DE PROF. ESPECIALISTAS

SELECT
	NOME_PROFESSOR,
	TITULACAO
FROM
	PROFESSOR
WHERE 
	TITULACAO = 'ESPECIALISTA';
	
	
-- Professores que lecionam no curso SISTEMA DE INFORMAÇÃO

SELECT
	NOME_PROFESSOR,
	CURSOS
FROM
	PROFESSOR
WHERE 
	CURSOS = 'SISTEMA DE INFORMAÇÃO';


-- Contar o número de alunos matriculados em ENGENHARIA DA COMPUTAÇÃO

SELECT  
	COUNT(*) AS "TOTAL DE ALUNOS"
FROM 
	ALUNO A
INNER JOIN
	CURSO C
ON 
	A.ID_CURSO = C.IDCURSO
WHERE
	NOME_CURSO = 'ENGENHARIA DA COMPUTAÇÃO';
	

-- Média da idade dos alunos matriculados em SISTEMA DE INFORMAÇÃO

SELECT
	ROUND(AVG(IDADE),1) AS "MÉDIA DA IDADE"
FROM 
	ALUNO A
INNER JOIN 
	CURSO C 
ON 	
	A.ID_CURSO = C.IDCURSO
WHERE
	C.NOME_CURSO = 'SISTEMAS DE INFORMAÇÃO';


-- Liste as Apresentações marcadas para o laboratório Lab. 04	

SELECT 
	T.TITULO AS "TCC",
	A.DATA,
	A.HORA,
	A.LOCALIZACAO AS "SALA"
FROM
	APRESENTACAO A
INNER JOIN
	TCC T
ON
	A.ID_TCC = T.IDTCC
WHERE
	A.LOCALIZACAO LIKE  '%04';
	

-- Média das notas obtidas nas Apresentações de TCC

SELECT
	SUM(NOTA_FINAL) AS "TOTAL DAS NOTAS",
	ROUND(AVG(NOTA_FINAL),2) AS "MÉDIA DAS NOTAS"
FROM 
	APRESENTACAO;
	

-- Maior nota obtida nas Apresentações de TCC

SELECT 
	T.TITULO AS "TCC",
	A.DATA,
	A.NOTA_FINAL AS "MAIOR NOTA"
FROM
	APRESENTACAO A
INNER JOIN
	TCC T
ON
	A.ID_TCC = T.IDTCC
WHERE
	A.NOTA_FINAL = (SELECT MAX(NOTA_FINAL) FROM APRESENTACAO);
	